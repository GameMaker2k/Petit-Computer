@PROTOP
CLS
ACLS
CLEAR
COLOR 0
INPUT "Insert a UPC-A: "; UPCA$
CLS
ACLS
IF LEN(UPCA$)<12 THEN STOP
IF LEN(UPCA$)>12 THEN STOP
COLOR 1
UPCA_SIZE=LEN(UPCA$)
STARTI=0
DIM UPC_ARRAY$(12)
DIM UPC_ARRAY(12)
@LOOP1
UPC_ARRAY$(STARTI)=MID$(UPCA$,STARTI,1)
UPC_ARRAY(STARTI)=VAL(MID$(UPCA$,STARTI,1))
STARTI=STARTI+1
IF STARTI==12 GOTO @LOOP1END
GOTO @LOOP1
@LOOP1END
ODDSUM=(UPC_ARRAY(0)+UPC_ARRAY(2)+UPC_ARRAY(4)+UPC_ARRAY(6)+UPC_ARRAY(8)+UPC_ARRAY(10))*3
EVENSUM=UPC_ARRAY(1)+UPC_ARRAY(3)+UPC_ARRAY(5)+UPC_ARRAY(7)+UPC_ARRAY(9)
ALLSUM=ODDSUM+EVENSUM
CHECKSUM=ALLSUM%10
IF CHECKSUM>0 THEN CHECKSUM=ABS(CHECKSUM-10)
IF CHECKSUM!=UPC_ARRAY(11) THEN UPCA$=SUBST$(UPCA$,11,1,STR$(CHECKSUM))
IF CHECKSUM!=UPC_ARRAY(11) THEN UPC_ARRAY$(11)=STR$(CHECKSUM)
IF CHECKSUM!=UPC_ARRAY(11) THEN UPC_ARRAY(11)=CHECKSUM
GFILL 0,0,113,62,15
GCOLOR 14
GLINE 9,10,9,54
GLINE 11,10,11,54
DIM LEFTCOLOR(7)
C1START=0
C1END=6
LINESTART=12
@C1LOOP
IF C1START==0 GOTO @LINE1SIZE1
IF C1START!=0 GOTO @LINE1SIZE2
@LINE1SIZE1
LINESIZE=54
GOTO @LINE1SIZEDONE
@LINE1SIZE2
LINESIZE=48
GOTO @LINE1SIZEDONE
@LINE1SIZEDONE
LEFTCOLOR(0)=0
LEFTCOLOR(1)=0
LEFTCOLOR(2)=0
LEFTCOLOR(3)=0
LEFTCOLOR(4)=0
LEFTCOLOR(5)=0
LEFTCOLOR(6)=0
IF UPC_ARRAY$(C1START)=="0" GOTO @INC1NUM0
IF UPC_ARRAY$(C1START)=="1" GOTO @INC1NUM1
IF UPC_ARRAY$(C1START)=="2" GOTO @INC1NUM2
IF UPC_ARRAY$(C1START)=="3" GOTO @INC1NUM3
IF UPC_ARRAY$(C1START)=="4" GOTO @INC1NUM4
IF UPC_ARRAY$(C1START)=="5" GOTO @INC1NUM5
IF UPC_ARRAY$(C1START)=="6" GOTO @INC1NUM6
IF UPC_ARRAY$(C1START)=="7" GOTO @INC1NUM7
IF UPC_ARRAY$(C1START)=="8" GOTO @INC1NUM8
IF UPC_ARRAY$(C1START)=="9" GOTO @INC1NUM9
@INC1NUM0
LEFTCOLOR(3)=1
LEFTCOLOR(4)=1
LEFTCOLOR(6)=1
GOTO @INC1END
@INC1NUM1
LEFTCOLOR(2)=1
LEFTCOLOR(3)=1
LEFTCOLOR(6)=1
GOTO @INC1END
@INC1NUM2
LEFTCOLOR(2)=1
LEFTCOLOR(5)=1
LEFTCOLOR(6)=1
GOTO @INC1END
@INC1NUM3
LEFTCOLOR(1)=1
LEFTCOLOR(2)=1
LEFTCOLOR(3)=1
LEFTCOLOR(4)=1
LEFTCOLOR(6)=1
GOTO @INC1END
@INC1NUM4
LEFTCOLOR(1)=1
LEFTCOLOR(5)=1
LEFTCOLOR(6)=1
GOTO @INC1END
@INC1NUM5
LEFTCOLOR(1)=1
LEFTCOLOR(2)=1
LEFTCOLOR(6)=1
GOTO @INC1END
@INC1NUM6
LEFTCOLOR(1)=1
LEFTCOLOR(3)=1
LEFTCOLOR(4)=1
LEFTCOLOR(5)=1
LEFTCOLOR(6)=1
GOTO @INC1END
@INC1NUM7
LEFTCOLOR(1)=1
LEFTCOLOR(2)=1
LEFTCOLOR(3)=1
LEFTCOLOR(5)=1
LEFTCOLOR(6)=1
GOTO @INC1END
@INC1NUM8
LEFTCOLOR(1)=1
LEFTCOLOR(2)=1
LEFTCOLOR(4)=1
LEFTCOLOR(5)=1
LEFTCOLOR(6)=1
GOTO @INC1END
@INC1NUM9
LEFTCOLOR(3)=1
LEFTCOLOR(5)=1
LEFTCOLOR(6)=1
GOTO @INC1END
@INC1END
INC1START=0
INC1END=7
@INC1LOOP
IF LEFTCOLOR(INC1START)==0 GOTO @DRAW1LINE0
IF LEFTCOLOR(INC1START)==1 GOTO @DRAW1LINE1
@DRAW1LINE0
GCOLOR 15
GLINE LINESTART,10,LINESTART,LINESIZE
LINESTART=LINESTART+1
GOTO @DRAW1LINEDONE
@DRAW1LINE1
GCOLOR 14
GLINE LINESTART,10,LINESTART,LINESIZE
LINESTART=LINESTART+1
GOTO @DRAW1LINEDONE
@DRAW1LINEDONE
INC1START=INC1START+1
IF INC1START==INC1END GOTO @INC1ENDLOOP
GOTO @INC1LOOP
@INC1ENDLOOP
C1START=C1START+1
IF C1START==C1END GOTO @C1ENDLOOP
GOTO @C1LOOP
@C1ENDLOOP
GCOLOR 14
GLINE 55,10,55,54
GLINE 57,10,57,54
DIM RIGHTCOLOR(7)
C2START=6
C2END=12
LINESTART=59
@C2LOOP
IF C2START==11 GOTO @LINE2SIZE1
IF C2START!=11 GOTO @LINE2SIZE2
@LINE2SIZE1
LINESIZE=54
GOTO @LINE2SIZEDONE
@LINE2SIZE2
LINESIZE=48
GOTO @LINE2SIZEDONE
@LINE2SIZEDONE
RIGHTCOLOR(0)=0
RIGHTCOLOR(1)=0
RIGHTCOLOR(2)=0
RIGHTCOLOR(3)=0
RIGHTCOLOR(4)=0
RIGHTCOLOR(5)=0
RIGHTCOLOR(6)=0
IF UPC_ARRAY$(C2START)=="0" GOTO @INC2NUM0
IF UPC_ARRAY$(C2START)=="1" GOTO @INC2NUM1
IF UPC_ARRAY$(C2START)=="2" GOTO @INC2NUM2
IF UPC_ARRAY$(C2START)=="3" GOTO @INC2NUM3
IF UPC_ARRAY$(C2START)=="4" GOTO @INC2NUM4
IF UPC_ARRAY$(C2START)=="5" GOTO @INC2NUM5
IF UPC_ARRAY$(C2START)=="6" GOTO @INC2NUM6
IF UPC_ARRAY$(C2START)=="7" GOTO @INC2NUM7
IF UPC_ARRAY$(C2START)=="8" GOTO @INC2NUM8
IF UPC_ARRAY$(C2START)=="9" GOTO @INC2NUM9
@INC2NUM0
RIGHTCOLOR(0)=1
RIGHTCOLOR(1)=1
RIGHTCOLOR(2)=1
RIGHTCOLOR(5)=1
GOTO @INC2END
@INC2NUM1
RIGHTCOLOR(0)=1
RIGHTCOLOR(1)=1
RIGHTCOLOR(4)=1
RIGHTCOLOR(5)=1
GOTO @INC2END
@INC2NUM2
RIGHTCOLOR(0)=1
RIGHTCOLOR(1)=1
RIGHTCOLOR(3)=1
RIGHTCOLOR(4)=1
GOTO @INC2END
@INC2NUM3
RIGHTCOLOR(0)=1
RIGHTCOLOR(5)=1
GOTO @INC2END
@INC2NUM4
RIGHTCOLOR(0)=1
RIGHTCOLOR(2)=1
RIGHTCOLOR(3)=1
RIGHTCOLOR(4)=1
GOTO @INC2END
@INC2NUM5
RIGHTCOLOR(0)=1
RIGHTCOLOR(3)=1
RIGHTCOLOR(4)=1
RIGHTCOLOR(5)=1
GOTO @INC2END
@INC2NUM6
RIGHTCOLOR(0)=1
RIGHTCOLOR(2)=1
GOTO @INC2END
@INC2NUM7
RIGHTCOLOR(0)=1
RIGHTCOLOR(4)=1
GOTO @INC2END
@INC2NUM8
RIGHTCOLOR(0)=1
RIGHTCOLOR(3)=1
GOTO @INC2END
@INC2NUM9
RIGHTCOLOR(0)=1
RIGHTCOLOR(1)=1
RIGHTCOLOR(2)=1
RIGHTCOLOR(4)=1
GOTO @INC2END
@INC2END
INC2START=0
INC2END=7
@INC2LOOP
IF RIGHTCOLOR(INC2START)==0 GOTO @DRAW2LINE0
IF RIGHTCOLOR(INC2START)==1 GOTO @DRAW2LINE1
@DRAW2LINE0
GCOLOR 15
GLINE LINESTART,10,LINESTART,LINESIZE
LINESTART=LINESTART+1
GOTO @DRAW2LINEDONE
@DRAW2LINE1
GCOLOR 14
GLINE LINESTART,10,LINESTART,LINESIZE
LINESTART=LINESTART+1
GOTO @DRAW2LINEDONE
@DRAW2LINEDONE
INC2START=INC2START+1
IF INC2START==INC2END GOTO @INC2LOOPEND
GOTO @INC2LOOP
@INC2LOOPEND
C2START=C2START+1
IF C2START==C2END GOTO @C2ENDLOOP
GOTO @C2LOOP
@C2ENDLOOP
GCOLOR 14
GLINE 101,10,101,54
GLINE 103,10,103,54
GCOPY 0,0,113,62,142,0,TRUE
GCOPY 0,0,113,62,0,129,TRUE
GCOPY 0,0,113,62,0,129,TRUE
GCOPY 0,0,113,62,142,129,TRUE
PRINT " "
PRINT " "
PRINT " "
PRINT " "
PRINT " "
PRINT " "
PRINT " "
PRINT " "
PRINT " "
PRINT " "
PRINT " "
COLOR 0
PRINT " "; UPCA$; " "
PRINT "CheckSum: "; CHECKSUM
INPUT "Press Enter to continue"; RESTART$
IF RESTART$=="Y" GOTO @PROTOP
IF RESTART$=="y" GOTO @PROTOP
